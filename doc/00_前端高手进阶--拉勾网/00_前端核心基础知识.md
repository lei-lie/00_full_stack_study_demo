## 你真的了解HTML吗？

### 看不见的HTML标签及其使用场景

看不见的标签指的是`head`标签中的标签，例如`meta`

#### meta标签：自动刷新/跳转

##### 场景1

实现一个类似`PPT`自动播放的效果，在间隔一定时间后从`a`页面进入`b`页面

实现方案：

* 通过`javascript`的定时器实现

  ```javascript
   setTimeout(function() {
      window.location.href = 'page2.html'
   },3000)
  ```

  

* 通过`meta`标签实现

  ```javascript
  <meta http-equiv="Refresh" content="5;URL=page1.html"></meta>
  ```

  

##### 场景2

每个一页面就需要刷新页面的大屏监控

实现方案：

* 定时器

  ```javascript
   setInterval(() => {
       window.location.reload()
     }, 1000);
  ```

  

* 通过meta标签

  ```javascript
  <meta http-equiv="Refresh" content="5;"></meta>
  ```

  

##### meta自动刷新和跳转的功能很少使用原因

* 开发者对`meta`标签用法缺乏深入了解
* 使用`meta`标签实现自动数显和跳转的操作是不可取消的，即是效果会一直存在

> 所以对刷新时间间隔或者需要手动取消的，还是推荐使用` JavaScript `定时器来实现。但是，如果你只是想实现页面的定时刷新或跳转（比如某些页面缺乏访问权限，在 x 秒后跳回首页这样的场景）建议你可以实践下 `meta` 标签的用法。



#### title标签和Hack手段：消息提醒

`B/S`架构应用的优缺点

优点：

* 版本更新方便
* 跨平台
* 跨终端

缺点：

处理即时通信场景很复杂

原因是：B/S架构的应用前后端通信深度依赖于HTTP协议，而HTTP协议采用“请求-响应”模式，这就决定了服务端只能被动地发送数据（即是只有前端发起请求，后段服务监听到请求时，才会进行响应），而不能主动的向客户端推动消息；



解决方案：

1. 在客户端通过轮询机制获取最新消息

   ```html
   <!DOCTYPE html>
   <html lang="en">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>title标签与Hack手段</title>
   </head>
   <body>
       <h1>修改浏览器title</h1>
       <script >
           let msgNum = 1 // 消息条数
           let count = 0 // 计数器
           const timer = setInterval(() => {
               count = (count + 1) % 2
               if (msgNum === 0) {
                   document.title += '聊天页面'
                   clearInterval(timer)
                   return
               }
               const prefix = count % 2 ? `新消息${msgNum}` : ''
               document.title = `聊天页面--${prefix}`
           },1000)
       </script>
   </body>
   </html>
   ```

   

2. HTML5中的websocket协议



### 性能优化![]()

前端性能问题：

* 渲染速度慢
* 请求时间长



#### script标签：调整加载顺序提升渲染速度

> 由于浏览器的底层运行机制，渲染引擎在解析 HTML 时，若遇到 script 标签引用文件，则会暂停解析过程，同时通知网络线程加载文件，文件加载后会切换至 JavaScript 引擎来执行对应代码，代码执行完成之后切换至渲染引擎继续渲染页面。
>
> 在这一过程中可以看到，页面渲染过程中包含了请求文件以及执行文件的时间，但页面的首次渲染可能并不依赖这些文件，这些请求和执行文件的动作反而延长了用户看到页面的时间，从而降低了用户体验。

减少请求文件以及执行文件的时间损耗的解决方案 -- 借助`script`标签的3个属性来实现

* `async`属性：立即请求脚本文件，但是不阻塞渲染引擎，而是脚本文件加载完毕完毕后阻塞渲染渲染引擎并立即执行脚本文件内容。（**即是加载脚本文件的同时渲染引擎仍然在工作，只是当脚本文件加载完成时，暂停渲染引擎的工作，切换到`JavaScript`引擎，让其执行脚本文件的内容。）**
* `defer`属性：立即请求脚本文件，但不阻塞渲染引擎，等到解析完`HTML`之后再执行脚本文件的内容（**即是加载脚本文件和渲染引擎同时工作，只是脚本文件内容的执行需要等到渲染引擎完成`HTML`内容的渲染工作后**）；
* `HTML5`标准`type`属性：对应值为`module`,让浏览器按照`ECMAScript 2015`标准将文件当做模块进行解析,默认阻塞效果和`defer`相同，也可以配合`async`在请求完成后立即执行；

![script标签的async,defer,type属性](D:\00_workspace\00_mine\00_full_stack_study_demo\doc\00_前端高手进阶--拉勾网\script标签的async,defer,type属性.png)

> 从上图可知，采用三种属性都能够减少请求脚本文件引起的阻塞时间，但是只有`defer`属性以及`type="module"`情况下能保证渲染引擎的优先执行，从而减少执行脚本文件内容消耗的时间，让用户更快地看见页面（即使这些页面内容可能并没有完全地显示）。

即是：

减少请求脚本文件引起的阻塞时间的方式：

* `async`
* `defer`
* `type="module"`

减少执行脚本文件消耗的时间的方式：

* `defer`
* `type=module`

这种减少执行脚本文件消耗时间的方式原理是保证渲染引擎工作Ja完成之后,`JavaScript`引擎再工作

## 学习资料

[前端高手进阶](https://kaiwu.lagou.com/course/courseInfo.htm?courseId=180#/detail/pc?id=3171)